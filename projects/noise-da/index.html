<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Denoising as Adaptation: Noise-Space Domain Adaptation for Image Restoration.">
  <meta name="keywords" content="Image Restoration, Diffusion Model, Domain Adaptation">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Noise-DA</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./images/logo.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <!-- Vendor Stylesheets -->
  <!--=================js==========================-->
  <link rel="stylesheet" href="./static/css/tab_gallery.css">
  <link rel="stylesheet" href="./static/css/juxtapose.css">
  <!-- <script src="./static/js/index.js"></script> -->
  <!-- <link rel="stylesheet" href="./menlo"> -->
  <link rel="stylesheet" href="./static/css/image_card_fader.css">
  <link rel="stylesheet" href="./static/css/image_card_slider.css">
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://kangliao929.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Denoising as Adaptation: Noise-Space Domain Adaptation for Image Restoration</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://kangliao929.github.io">Kang Liao</a>, </span>
            <span class="author-block">
              <a href="https://zsyoaoa.github.io">Zongsheng Yue</a>, </span>
            <span class="author-block">
              <a href="https://wzhouxiff.github.io/">Zhouxia Wang</a>, </span>
            <span class="author-block">
              <a href="https://www.mmlab-ntu.com/person/ccloy/index.html">Chen Change Loy</a>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">S-Lab, Nanyang Technological University</span>
          </div>

          <div class="is-size-5 publication-conference">
              <span class="author-block"><b>ICLR 2025</b></span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2406.18516"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/KangLiao929/Noise-DA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              <!--
              </span>
              Dataset Link.
              <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!--=================Teasers==========================-->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop has-text-centered">
      <!-- The expanding image container -->
      <div class="tab_container">
        <!-- Close the image -->
        <!-- <span onclick="this.parentElement.style.display='none'" class="closebtn">&times;</span> -->

        <!-- Expanded image -->
        <div id="juxtapose-embed" data-startingposition="30%" data-animate="true" class="juxtapose"
          style="height: 700px; width: 700px;">
          <!-- <div class="jx-slider">
            <div class="jx-handle " style="left: 50%;">
              <div class="jx-arrow jx-left"></div>
              <div class="jx-control">
                <div class="jx-controller" tabindex="0" role="slider" aria-valuenow="50" aria-valuemin="0"
                  aria-valuemax="100"></div>
              </div>
              <div class="jx-arrow jx-right"></div>
            </div>
            <div class="jx-image jx-left " style="width: 50%;"><img src="./src/UDC_1.png" alt="">
              <div class="jx-label" tabindex="0">UDC images</div>
            </div>
            <div class="jx-image jx-right " style="width: 50%;"><img src="./src/AF_1.png" alt="">
              <div class="jx-label" tabindex="0">AlignFormer results</div>
            </div><a href="https://juxtapose.knightlab.com" target="_blank" rel="noopener" class="jx-knightlab">
              <div class="knightlab-logo"></div><span class="juxtapose-name">JuxtaposeJS</span>
            </a>
          </div> -->
        </div>

        <div>
          <div id="juxtapose-hidden"></div>
        </div>

        <!-- Image text -->
        <div id="imgtext"></div>
      </div>

      <!-- The grid: four columns -->
      <div class="tab_row">
        <div class="tab_column">
          <img src="images/denoise1_lq.png" onclick="tab_gallery_click('denoise1');">
        </div>
        <div class="tab_column">
          <img src="images/denoise4_lq.png" onclick="tab_gallery_click('denoise4');">
        </div>
        <div class="tab_column">
          <img src="images/denoise3_lq.png" onclick="tab_gallery_click('denoise3');">
        </div>
        <div class="tab_column">
          <img src="images/derain0_lq.png" onclick="tab_gallery_click('derain0');">
        </div>
        <div class="tab_column">
          <img src="images/derain2_lq.png" onclick="tab_gallery_click('derain2');">
        </div>
        <div class="tab_column">
          <img src="images/derain1_lq.png" onclick="tab_gallery_click('derain1');">
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
           In this work, we show the first attempt at addressing domain adaptation in the noise space for image restoration. In particular, by leveraging the unique property of how auxiliary conditional inputs influence the multi-step denoising process, we derive a meaningful <b><i>diffusion loss</i></b> that guides the restoration model in progressively aligning both restored synthetic and real-world outputs with a target clean distribution. We refer to this method as denoising as adaptation. To prevent shortcuts during joint training, we present crucial strategies such as channel-shuffling layer and residual-swapping contrastive learning in the diffusion model. They implicitly blur the boundaries between conditioned synthetic and real data and prevent the reliance of the model on easily distinguishable features. Experimental results on three classical image restoration tasks, namely denoising, deblurring, and deraining, demonstrate the effectiveness of the proposed method.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
    <!--=================Motivation and Method==========================-->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Motivation and Framework</h2>
        <div class="content has-text-justified">
      <div style="text-align: center; vertical-align:middle">
        <img src="images/framework.png" width="800">
      </div>
      <div align="center">
        <b>An overview of the proposed denoising as adaptation framework</b>
      </div>
      <p>
        
      </p>
      <p>
      Our main idea stems from the observation in the above figure (a). Here, we measure the noise prediction error of a diffusion model conditioned on a noisy version of the target image. The trend shows that conditions with fewer corruption levels facilitate lower prediction errors of the diffusion model. In other words, ``good'' conditions give low diffusion loss, and ``bad'' conditions lead to high diffusion loss. Our method leverages this phenomenon by taming a diffusion model conditioned on both the restored synthetic image and restored real image from the restoration network, as shown in the above figure (b). Both networks are jointly trained, with the restoration network optimized to provide good conditions to minimize the diffusion model's noise prediction error, aiming for a clean target distribution. After training, the diffusion model is discarded, leaving only the trained restoration network for inference.
      </p>
    </div>
  </div>
</div>
    <!--=================Shortcut==========================-->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Eliminating Shortcut Learning in Diffusion</h2>
        <div class="content has-text-justified">
      <div style="text-align: center; vertical-align:middle">
        <img src="images/shortcut.png" width="800">
      </div>
      <div align="center">
        <b>An example of the shortcut learning occurred in diffusion</b>
      </div>
      <p>
        
      </p>
      <p>
      The joint training of the restoration model and diffusion model, however, could lead to trivial solutions or shortcuts. For example, it is easy to distinguish the synthetic and real-world conditions by the pixel similarity or the channel index. Consequently, the restoration network will cheat the diffusion network by roughly degrading the high-frequency information in real-world images.
      </p>
      <p>
        To mitigate this issue, we propose crucial strategies to fool the diffusion model, making it hard to discriminate between these two conditions. Specifically, we incorporate a channel-shuffling layer into the diffusion model and design a residual-swapping contrastive learning strategy to ensure the model genuinely learns to restore images accurately, rather than relying on easily distinguishable features. These strategies implicitly blur the boundaries between synthetic and real data, ensuring that both contribute effectively during joint training and facilitating their alignment with the target distribution. More details can be found in Section 3.2 of the paper.
      </p>
    </div>
  </div>
</div>

    <!--=================Discussion==========================-->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Discussion to Previous Domain Adaptation</h2>
        <div class="content has-text-justified">
      <div style="text-align: center; vertical-align:middle">
        <img src="images/da.png" width="800">
      </div>
      <div align="center">
        <b>Overview of three domain adaptation strategies</b>
      </div>
      <p>
        
      </p>
      <p>
      We compare different domain adaptation (DA) strategies here: (a) Feature-space DA aligns the intermediate features across source and target domains. (b) Pixel-space DA translates source data to the ``style" of the target domain through adversarial learning. (c) The proposed noise-space DA is specifically designed for low-level vision. It gradually adapts the results from both source and target domains to the target clean image distribution, via multi-step denoising in the pixel-wise noise space. Particularly, the function network represents a restoration network in the context of image restoration.
      </p>
    </div>
  </div>
</div>

    <!--=================Scalability==========================-->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Scalability</h2>
        <div class="content has-text-justified">
      <div style="text-align: center; vertical-align:middle">
        <img src="images/scalability.png" width="410">
      </div>
      <div align="center">
        <b>Scalability of the proposed method on different restoration network architectures</b>
      </div>
      <p>
        
      </p>
      <p>
      Our work serves as a general domain adaptation strategy for various image restoration tasks, which is scalable and friendly to any restoration network. It is also interesting that for each type of architecture, our method can facilitate better performance as the complexity of the restoration network increases, demonstrating its effectiveness in addressing the overfitting problem of large models.
      </p>
    </div>
  </div>
</div>

    <!--=================Results==========================-->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">More Visual Comparison Results</h2>
        <div class="content has-text-justified">
        <div style="text-align: center; vertical-align:middle">
          <img src="images/denoise_sp.png" width="800">
        </div>
        <div align="center">
          <b>Visual results on SIDD denoising dataset</b>
        </div>
        <p>
          
        </p>
        <div style="text-align: center; vertical-align:middle">
          <img src="images/derain_sp.png" width="800">
        </div>
        <div align="center">
          <b>Visual results on SPA deraining dataset</b>
        </div>
        <p>
          
        </p>
        <div style="text-align: center; vertical-align:middle">
          <img src="images/deblur_sp.png" width="800">
        </div>
        <div align="center">
          <b>Visual results on RealBlur-J deblurring dataset</b>
        </div>
    </div>
  </div>
</div>
</div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{liao2024denoising,
      title={Denoising as Adaptation: Noise-Space Domain Adaptation for Image Restoration},
      author={Liao, Kang and Yue, Zongsheng and Wang, Zhouxia and Loy, Chen Change},
      journal={arXiv preprint arXiv:2406.18516},
      year={2024}
    }</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            If you have any question, please contact us at <strong>kang.liao@ntu.edu.sg</strong>.
          </p>
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            Website adapted from the following <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Image Slider Javascripts -->
<!--=================Functions==========================-->
<script src="./static/js/juxtapose.js"></script>


<script>
  var slider;
  let origImages = [
    { "src": "images/denoise1_lq.png", "label": "Input", },
    { "src": "images/denoise1_hq.png", "label": "Ours", }
  ];
  let origOptions = {
    "makeResponsive": true,
    "showLabels": true,
    "mode": "horizontal",
    "showCredits": true,
    "animate": true,
    "startingPosition": "50"
  };

  const juxtaposeSelector = "#juxtapose-embed";
  const transientSelector = "#juxtapose-hidden";


  function tab_gallery_click(name) {
    // Get the expanded image
    let inputImage = {
      label: "Input",
    };
    let outputImage = {
      label: "Ours",
    };

    inputImage.src = "images/".concat(name, "_lq", ".png")
    outputImage.src = "images/".concat(name, "_hq", ".png")

    let images = [inputImage, outputImage];
    let options = slider.options;
    options.callback = function (obj) {
      var newNode = document.getElementById(obj.selector.substring(1));
      var oldNode = document.getElementById(juxtaposeSelector.substring(1));
      console.log(obj.selector.substring(1));
      console.log(newNode.children[0]);
      oldNode.replaceChild(newNode.children[0], oldNode.children[0]);
      //newNode.removeChild(newNode.children[0]);

    };

    slider = new juxtapose.JXSlider(transientSelector, images, options);
  };

  (function () {
    slider = new juxtapose.JXSlider(
      juxtaposeSelector, origImages, origOptions);
    //document.getElementById("left-button").onclick = replaceLeft;
    //document.getElementById("right-button").onclick = replaceRight;
  })();
  // Get the image text
  var imgText = document.getElementById("imgtext");
  // Use the same src in the expanded image as the image being clicked on from the grid
  // expandImg.src = imgs.src;
  // Use the value of the alt attribute of the clickable image as text inside the expanded image
  imgText.innerHTML = name;
  // Show the container element (hidden with CSS)
  // expandImg.parentElement.style.display = "block";

  $(".flip-card").click(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("out");
    $(div_front).removeClass("in");

    $(div_back).addClass("in");
    $(div_back).removeClass("out");

  });

  $(".flip-card").mouseleave(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("in");
    $(div_front).removeClass("out");

    $(div_back).addClass("out");
    $(div_back).removeClass("in");

  });
</script>

</body>
</html>
